<!-- views/profile.ejs -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="stylesheets/style.css">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="javascript/ajax.js"></script>
    <title>BucketList</title>

    <!-- twitter -->
    <script type="text/javascript" src="/socket.io/socket.io.js"></script>
  <body>
    <!--NAV BAR-->
    <nav class="navbar navbar-inverse">
      <div class="container-fluid">
        <div class="navbar-header">
          <a class="navbar-brand" href="/">BucketList</a>
        </div>
        <div>
          <ul class="nav navbar-nav">
            <li><a href="/">Home</a></li>
            <li><a href="/logout">Log Out</a></li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- NAV BAR END -->
  <!-- CONTAINTER -->
  <div class="container">

      <div class="page-header text-center">
          <h1><span class="fa fa-user"></span> <%= user.local.email %></h1>
      </div>

    <div class="row">
        <!-- USER INFORMATION -->
        <div class="col-sm-6">
          <div class="well">
              <p>
                <strong><br>   <% for( i = 0; i < user.items.length; i++){ %>
                    <p>
                        Title: <%= user.items[i].title %><br>
                        Entry: <%= user.items[i].entry %><br>
                        Catagory: <%= user.items[i].category %><br>
                    </p>

                <% }; %>
                </strong>
                <a class="btn btn-default" href="/newitem" role="button">New Item</a>
              </p>
          </div>
        </div>
        <!-- TWITTER -->
        <div class="col-sm-6 well">
          <div class="row center-block">
            <div class="input-group">
              <span class="input-group-btn">
                <button id="search-button" class="btn btn-default" type="button">Go!</button>
              </span>
              <input id="search-field" type="text" class="form-control" placeholder="Search for Tweets">
            </div><!-- /input-group -->
          </div><!-- /.col-lg-6 -->

          <div class="tweet-results row">
            <!-- TWEETS WILL POPULATE HERE -->
          </div>
        </div>
        <!-- TWITTER END -->

    </div>

    <!-- TWITTER WEB SOCKET SUBMIT FORM -->
    <p1 id="twitterSearchFor"></p1>
    <form action="/" name="search">
    <div class="form-group">
      <input id="searchTerm" type="text" class="form-control">
    </div>
    <input id="tweetSocketBtn" type="submit" class="btn btn-default">
    </form>
    <div id="tweet-container">
    <!-- WEB SOCKET TWEETS POPULATE HERE -->
    </div>

  </div>
  <!-- CONTAINER END -->
  </body>

  <footer>
    <p class='text-center '>
      &copy; BucketList 2015
    </p>
  </footer>


  <script>

      // TWITTER WEB SOCKET =====================================================================================
      $(function (){
        var socket = io();

        socket.on('connect', function() {
          console.log('Connected!');
        });

        socket.on('tweets', function(tweet) {
          var html = '<div class="row"><div class="col-md-6 col-md-offset-3 tweet"><img src="' + tweet.user_profile_image + '" class="avatar pull-left"/><div class="names"><span class="full-name">' + tweet.name + ' </span><span class="username">@' +tweet.screen_name + '</span></div><div class="contents"><span class="text">' + tweet.text + '</span></div></div></div>';
          $('#tweet-container').prepend(html);
        });

        $('form').submit(function(e){
          e.preventDefault();
          var search_term = $('#searchTerm').val();
          console.log("search term", search_term);
          socket.emit('updateTerm', search_term);
        });

        socket.on('updatedTerm', function(searchTerm) {
          $('#twitterSearchFor').text('Retrieving tweets about '+ searchTerm + '...');
          console.log(searchTerm);
        });

      });

      $("#tweetSocketBtn").click(function(){
        $('#twitterSearchFor').fadeOut(4000)
      });


  </script>


</html>
